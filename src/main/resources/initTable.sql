DROP TABLE genres CASCADE;
DROP TABLE events CASCADE;
DROP TABLE IF EXISTS events_genres;

CREATE TABLE events
(
    event_id    int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title       varchar,
    first_date  timestamp,
    last_date   timestamp,
    theatre     varchar,
    description varchar,
    event_url   varchar,
    image_url   varchar,
    min_price   int,
    max_price   int,
    next_show   timestamp
);

CREATE TABLE genres
(
    genre_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    genre    varchar UNIQUE
);

CREATE TABLE events_genres
(
    event_id int REFERENCES events (event_id) ON DELETE CASCADE,
    genre_id int REFERENCES genres (genre_id) ON DELETE CASCADE,
    PRIMARY KEY (event_id, genre_id)
);